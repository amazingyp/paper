% !TeX root = ../main.tex

\chapter{总结和展望}
\section{论文总结}%7.1
本文的撰写依据主要来源于公司对象存储系统的存储引擎部分的演进，为了实现低成本的目标引入了纠删码存储，然而系统中多副本存储引擎和纠删码存储引擎是相互分离的。当想要改变对象存储方式时，需要将对象数据进行系统级的迁移，为整个系统增加了额外的开销；另外系统需要维护两个存储引擎，维护成本较高。为了解决上面的问题，我们做了以下工作。

第一，设计了基于条带的文件分配方式，将文件以条带的形式在系统中存储，使纠删码系统和多副本系统这两种存储方式不再分离，文件的冗余方式可以直接从多副本转向纠删码，减少了迁移的开销和维护成本。

第二，系统设计了磁盘划分方案，使系统不再依赖操作系统的文件管理功能，提高了磁盘的利用率，同时充分考虑了磁盘的物理结构，有效减少写数据时磁头移动，提升写入性能。

第三，引入条带可以将一部分的元数据内容放到存储引擎中保存，将原来的简单的一级元数据映射转为二级元数据映射，有效减轻元数据服务的压力，提高元数据查找性能。

本系统主要的技术特色是对条带分配的功能进行扩展，一般而言，使用条带来分配文件主要考虑的是纠删码的应用，将一个文件分配成若干块然后根据分配的结果来计算EC校验块。而本系统设计的条带还考虑了多副本系统到纠删码系统的迁移问题，当文件需要将冗余方案由多副本转移为纠删码时，由于副本内容也是安排在条带上的，因此只需将条带中的冗余块进行删除即可。除此之外，本系统的另一技术特色是设计了磁盘划分方案，系统中的数据直接写入到磁盘中，相关的元数据由系统维护，不再由操作系统管理，这种优化在分布式存储领域是较为新颖的设计。

目前该项目已经在实习所在公司投入使用，是部门的一项核心产品。系统上线后，需要将存储在旧系统的数据迁移到新系统中，由于数据众多，且迁移时需要考虑系统可用性和数据可靠性，需要人工进行辅助，因此这是一个漫长的过程。目前为止，已经有部分集群完全完成了迁移，相较于之前的系统，最大的改变是，文件由多副本形式转为纠删码形式时，系统内部不再需要数据复制转移，这能够减少系统CPU、IO、网络等资源的占用，从整体上提升了系统的性能，也节约了部署系统的机器成本，具有一定的经济效益；除此之外，得益于新系统的磁盘划分方案，数据的读取和写入性能有一定的提升；最后，由于条带元信息是由存储引擎内部进行保存，能够分担元数据数据库的存储压力，可以观察到新系统所占用的元数据存储空间有所减少。

本系统是我在公司参与时间最久，完成度最高的一个系统，它具有完整的软件开发流程。本文按照软件的开发周期，从需求分析出发，在需求的基础上，介绍了系统的概要设计，同时阐述了系统中的模块组成以及它们的详细设计与实现方案，为了验证系统是否满足需求，也对系统做了相关测试。

\section{问题和展望}%7.2
本系统是一个复杂的系统，论文中重点展示了基于条带的文件分配方式是如何在系统中发挥作用的，实际上还有很多值得讨论和改进的地方，以下列举两个比较重要的问题。

第一，是条带的回收问题，当一个文件被删除时，磁盘上的实际内容和元数据中的记录将会被删除，但是在存储系统内部，为这个文件分配的条带仍然存在，我们需要设计一个算法来收集这些条带，释放已被分配的条带，减轻存储引擎内部的元数据存储压力。

第二，系统在进行文件冗余方式的转变时可以丰富转变策略，例如对于需要频繁读写的文件，可以不急于转为纠删码形式，这样可以减少读文件发生错误时解码的开销；而对于需要归档的文件，可以直接转为纠删码存储，能够有效地减少存储成本。
